/* Author: Drew Chase */
class Parser{static ExcelToCSV(e){try{const t=XLSX.read(e,{type:"binary"}),r=t.Sheets[t.SheetNames[0]];return XLSX.utils.sheet_to_csv(r).replace(/,+/g,",")}catch{return alert("Unable to parse excel file, This usually means that the file is not in the correct format and needs to be cleaned/modified."),""}}static CSVToJSON(e){e=e.replace(/"([^"]*)"/g,(e,t)=>t.replace(/,/g,""));try{let t=e.split("\n"),r=t[0].split(","),l="{";r.forEach(e=>{""!=e&&(l+=`"${e.trim().toLowerCase().replace(/\s/g,"_").replace(/\"/g,"")}":[],`)}),l=l.substring(0,l.length-1),l+="}";let a=JSON.parse(l);for(let e=1;e<t.length;e++){let l=t[e].split(",");for(let e=0;e<l.length;e++){let t=l[e],s=r[e];null!=s&&""!=s&&a[s.trim().toLowerCase().replace(/\s/g,"_")].push(t)}}return a}catch{return alert("Unable to parse file, This usually means that the file is not in the correct format and needs to be cleaned/modified."),""}}}